<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Keyword Scavenger Hunt</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: system-ui, sans-serif; background:#f4f6f8; padding:20px; }
.card { max-width:900px; margin:auto; background:#fff; padding:20px; border-radius:12px; }
.hunt { border:1px solid #ddd; padding:12px; border-radius:8px; margin-bottom:12px; }
button { margin:6px 6px 6px 0; padding:10px 16px; font-size:16px; }
input, textarea { width:100%; padding:8px; margin-bottom:10px; }

.overlay {
  position:fixed; inset:0; background:rgba(0,0,0,.6);
  display:none; align-items:center; justify-content:center;
  color:#fff; font-size:24px; z-index:999;
}

.qr { margin:12px 0; }
.pagebreak { page-break-before: always; }

@media print {
  button { display:none; }
}
</style>
</head>

<body>
<div class="card" id="app"></div>
<div class="overlay" id="overlay">‚ùå Wrong Code ‚Äî Try Again</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<script>
/* ========= UTIL ========= */
function uid(){ return Math.random().toString(36).slice(2,9); }

/* ========= DEFAULT HUNTS ========= */
const DEFAULT_HUNTS = {

escape:{
name:"Escape the House (10)",
intro:"Welcome! Your escape challenge begins now üè†",
clues:[
{clue:"I show your face but I‚Äôm not a photo.", keyword:"mirror"},
{clue:"I have pages but no homework.", keyword:"bookshelf"},
{clue:"I open wide but never talk.", keyword:"fridge"},
{clue:"I go round and round but never get dizzy.", keyword:"washing machine"},
{clue:"I have hands but no arms.", keyword:"clock"},
{clue:"I hide your feet when you‚Äôre not home.", keyword:"shoe rack"},
{clue:"I‚Äôm soft, I‚Äôm comfy, and I steal naps.", keyword:"couch"},
{clue:"I light up the dark but disappear by day.", keyword:"lamp"},
{clue:"I‚Äôm full of secrets, but I don‚Äôt talk.", keyword:"bedroom door"},
{clue:"You cracked every lock! Your colour is RED.", keyword:"red"}
],
finish:"üéâ Congratulations! You escaped the house!"
},

fortnite:{
name:"Fortnite IRL (12)",
intro:"You‚Äôve dropped in‚Ä¶ the hunt begins! ü™Ç",
clues:[
{clue:"Where controllers go when the game is off.", keyword:"gaming desk"},
{clue:"Where drinks recharge HP.", keyword:"fridge"},
{clue:"Where shoes hide from the storm.", keyword:"entrance"},
{clue:"Where tools live.", keyword:"garage"},
{clue:"Where everyone chills.", keyword:"lounge room"},
{clue:"You can‚Äôt win without sleep.", keyword:"bed"},
{clue:"Secrets behind closed doors.", keyword:"wardrobe"},
{clue:"Where devices recharge.", keyword:"phone charger"},
{clue:"High ground wins games.", keyword:"stairs"},
{clue:"Battles are watched, not played.", keyword:"tv"},
{clue:"Where snacks disappear.", keyword:"pantry"},
{clue:"VICTORY ROYALE üèÜ Your colour is SILVER.", keyword:"silver"}
],
finish:"üèÜ Victory Royale achieved!"
},

hacker:{
name:"System Breach (15)",
intro:"SYSTEM ONLINE. Initialising hunt‚Ä¶ üíª",
clues:[
{clue:"Device that controls all others.", keyword:"router"},
{clue:"Passwords written but never digital.", keyword:"notebook"},
{clue:"Cold data storage.", keyword:"fridge"},
{clue:"Commands typed, not spoken.", keyword:"keyboard"},
{clue:"One click can change everything.", keyword:"mouse"},
{clue:"Without this, the system fails.", keyword:"power board"},
{clue:"Clothes reset to default state.", keyword:"laundry"},
{clue:"Backup location.", keyword:"garage"},
{clue:"Pixels form reality here.", keyword:"monitor"},
{clue:"Entry requires permission.", keyword:"door"},
{clue:"Locked, hidden, not obvious.", keyword:"drawer"},
{clue:"Tracks everything over time.", keyword:"clock"},
{clue:"Operator rest zone.", keyword:"bed"},
{clue:"Admin-only access node.", keyword:"desk"},
{clue:"ROOT ACCESS GRANTED. Your colour is GREEN.", keyword:"green"}
],
finish:"‚úÖ System breached successfully."
}

};

/* ========= STATE ========= */
let userHunts = JSON.parse(localStorage.getItem("userHunts")||"{}");
let HUNTS = {...DEFAULT_HUNTS, ...userHunts};
function save(){ localStorage.setItem("userHunts",JSON.stringify(userHunts)); }

const q = new URLSearchParams(location.search);
const app = document.getElementById("app");

/* ========= ROUTER ========= */
if(q.get("start")) startPage(q.get("start"));
else if(q.get("play")) play();
else if(q.get("print")) printPage(q.get("print"));
else home();

/* ========= HOME (Parent only) ========= */
function home(){
app.innerHTML=`
<h1>Scavenger Hunts</h1>
${Object.entries(HUNTS).map(([k,h])=>`
<div class="hunt">
<h3>${h.name}</h3>
<button onclick="location='?print=${k}'">üñ® Print Instructions</button>
</div>
`).join("")}
`;
}

/* ========= START PAGE ========= */
function startPage(key){
const h = HUNTS[key];
if(!h) return home();

app.innerHTML = `
<h1>üéâ Welcome, Explorer!</h1>
<p>
You have been invited on a <strong>special scavenger hunt</strong>!
</p>
<p>
Around this place are <strong>hidden clues</strong> waiting to be found.
Each clue will lead you to the next one.
</p>
<p>
You might need to look carefully, think smart,
scan QR codes, and enter secret numbers.
</p>
<p>
There are no wrong turns ‚Äî just keep trying!
</p>
<button onclick="location='?play=${key}&s=1'">‚ñ∂Ô∏è Start the Hunt</button>
`;
}

/* ========= PLAY ========= */
function play(){
const key = q.get("play");
const step = parseInt(q.get("s")||0);
const h = HUNTS[key];
if(!h) return home();

if(step===0) return startPage(key);

if(step <= h.clues.length){
const c = h.clues[step-1];
app.innerHTML = `
<p><strong>Clue ${step}:</strong></p>
<p>${c.clue}</p>
<input id="ans" placeholder="Enter code">
<button onclick="check('${c.keyword}', '${key}', ${step+1})">Submit</button>
`;
return;
}

app.innerHTML = `<h2>${h.finish}</h2>`;
}

/* ========= CHECK ========= */
function check(correct, key, next){
const v = document.getElementById("ans").value.trim().toLowerCase();
if(v === correct){
location = `?play=${key}&s=${next}`;
}else{
overlay.style.display="flex";
setTimeout(()=>overlay.style.display="none",1500);
}
}

/* ========= PRINT ========= */
function printPage(key){
const h = HUNTS[key];
if(!h) return home();

app.innerHTML = `
<h2>${h.name} ‚Äì Parent Instructions</h2>

${h.clues.map((c,i)=>`
<p><strong>Clue ${i+1}:</strong> ${c.clue}</p>
<p><strong>Answer:</strong> ${c.keyword}</p>
<div class="qr"><canvas id="pqr${i}"></canvas></div>
<p><em>Parent notes:</em></p><br>
`).join("")}

<div class="pagebreak"></div>

<h2>QR Code Cut-Out Sheet</h2>
${h.clues.map((c,i)=>`
<div class="qr">
<p><strong>${c.keyword}</strong></p>
<canvas id="cqr${i}"></canvas>
</div>
`).join("")}
`;

h.clues.forEach((c,i)=>{
QRCode.toCanvas(document.getElementById("pqr"+i), c.keyword, {width:100});
QRCode.toCanvas(document.getElementById("cqr"+i), c.keyword, {width:120});
});
}
</script>
</body>
</html>